<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
      integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
    <title>Work Day Scheduler</title>
  </head>

  <body>
    <header class="jumbotron">
      <h1 class="display-3">Work Day Scheduler</h1>
      <p class="lead">A simple calendar app for scheduling your work day</p>
      <p id="currentDay" class="lead"></p>
    </header>
    <div class="container mt-5 mb-5 timeContainer">
      <!-- Timeblocks go here -->

      <!-- <div class="row">
        <div class="col-md-1 hour">8AM</div>
        <input type="text" name="" id="plannerIndex0" time-index="6" class="col-md-10 row">
        <button class="col-md-1 saveBtn"><img src="./Assets/save-icon-alpha.png" alt="Floppy Disk Outline Save Icon" class="saveImg"></button>
      </div> -->

    </div>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>
    <!-- <script src="./script.js"></script> -->
    <script>
      $(document).ready(function () {
        // Function to get the current time using moment()
        function updateTime() {
          const timeNow = moment().format("dddd, MMMM Do YYYY, h:mm:ss a");
          $('#currentDay').text(timeNow);
        }
        // Using setInterval() and moment() in the updateTime() function the time is being updated in real time. It's mostly just a big ball of wibbly wobbly, timey wimey stuff.
        setInterval(updateTime, 1000);
        updateTime();
        
        // General variables
        var dayHours = 24;
        var timeChart = 0;
        var timeIndex = 0;
        var isTwelveHourFormat = true;

        for (let i = 0; i < dayHours; i++) {

          // If set to 12 format this helps format the time block divs
          if (isTwelveHourFormat) {
            if (timeChart > 11) {
              timeChart = 0;
            }
          }

          // Writes AM or PM to the time block in the appropriate plce
          let amPM = "";
          if (timeIndex < 11 || timeIndex > 22) {
            amPM = "AM";
          } else {
            amPM = "PM";
          }


          timeIndex = timeIndex + 1;
          timeChart = timeChart + 1;
          
          // Writing the time block elements
          const rowDiv = $('<div>').attr('class', 'row').appendTo($('.timeContainer'));
          const hourDiv = $('<div>').attr('class', 'col-md-1 hour').text(timeChart + amPM).appendTo(rowDiv);
          var planInput = $('<input>').attr('type', 'text').attr('id', timeIndex).attr('class', 'col-md-10 planner-input').appendTo(rowDiv);
          const saveButton = $('<button>').attr('class', 'col-md-1 saveBtn').appendTo(rowDiv);
          const saveImg = $('<img>').attr('src', './Assets/save-icon-alpha.png').attr('alt', 'Floppy Disk Outlinve Save Icon').attr('class', 'saveImg').appendTo(saveButton);
        }

        // Function to update the background based on the current time
        function updateTimeBackground() {
          const currentHour = moment().format("H");
          
          for (let i = 1; i < (dayHours + 1); i++) {
            // Gets the current input field based on id
            var timeID = $('#' + i).attr('id');

            var newTimeID;
            // Sets the formating of 
            if (timeID < 10) {
              newTimeID = "0" + timeID;
            } else {
              newTimeID = timeID;
            }

            // Adds past, present, or future class based on the relation to the current time
            if (currentHour === newTimeID) {
              $('#' + timeID).addClass('present');
            } else if (currentHour < newTimeID) {
              $('#' + timeID).addClass('future');
            } else {
              $('#' + timeID).addClass('past');
            }
          }
        }
        
        setInterval(updateTimeBackground, 1000);
        updateTimeBackground();
      });
    </script>
  </body>
</html>
